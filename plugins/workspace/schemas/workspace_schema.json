{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Workspace Configuration",
  "description": "IntelliJ workspace project configuration - the workspace IS a project that contains capabilities, outcomes, plans, research, and status directories, with references to member projects",
  "schemaVersion": "2.0.0",
  "type": "object",
  "required": ["id", "name", "type", "rootPath", "directories", "projects"],

  "properties": {
    "id": {
      "type": "string",
      "description": "Unique workspace identifier (kebab-case)",
      "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
      "examples": ["lucid-workspace", "platform-services"]
    },

    "name": {
      "type": "string",
      "minLength": 2,
      "maxLength": 100,
      "description": "Human-readable workspace name",
      "examples": ["Lucid Workspace", "Platform Services"]
    },

    "description": {
      "type": "string",
      "description": "Purpose and scope of this workspace"
    },

    "type": {
      "type": "string",
      "enum": ["monorepo", "multi-repo", "hybrid"],
      "description": "Workspace organization type: monorepo (single repo, multiple packages), multi-repo (separate repos), hybrid (mix of both)"
    },

    "rootPath": {
      "type": "string",
      "description": "Absolute path to workspace root directory (the workspace project itself)",
      "examples": ["/Users/dev/Projects/lucid-workspace"]
    },

    "primaryStack": {
      "type": "string",
      "description": "Primary technology stack or language focus",
      "examples": ["Python", "TypeScript/Node.js", "Mixed"]
    },

    "directories": {
      "type": "object",
      "description": "Workspace operational directories - these exist within the workspace project",
      "required": ["capabilities", "outcomes", "status"],
      "properties": {
        "capabilities": {
          "type": "string",
          "description": "Path to capabilities directory (relative to workspace root)",
          "default": "capabilities/"
        },
        "outcomes": {
          "type": "string",
          "description": "Path to outcomes directory (relative to workspace root)",
          "default": "outcomes/"
        },
        "plans": {
          "type": "string",
          "description": "Path to plans directory (relative to workspace root)",
          "default": "plans/"
        },
        "research": {
          "type": "string",
          "description": "Path to research directory (relative to workspace root)",
          "default": "research/"
        },
        "status": {
          "type": "string",
          "description": "Path to status/summaries directory (relative to workspace root)",
          "default": "status/"
        },
        "schemas": {
          "type": "string",
          "description": "Path to JSON schemas directory (relative to workspace root)",
          "default": "schemas/"
        }
      }
    },

    "intellij": {
      "type": "object",
      "description": "IntelliJ IDEA workspace integration settings",
      "properties": {
        "ideaDirectory": {
          "type": "string",
          "description": "Path to .idea directory (relative to workspace root)",
          "default": ".idea/"
        },
        "workspaceFile": {
          "type": "string",
          "description": "Path to jb-workspace.xml file",
          "default": ".idea/jb-workspace.xml"
        },
        "modulesFile": {
          "type": "string",
          "description": "Path to modules.xml file",
          "default": ".idea/modules.xml"
        }
      }
    },

    "projects": {
      "type": "array",
      "description": "Projects that are part of this workspace (added via IntelliJ or /workspace:add)",
      "items": {
        "type": "object",
        "required": ["id", "name", "path", "type"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique project identifier within workspace (kebab-case)",
            "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$"
          },
          "name": {
            "type": "string",
            "description": "Human-readable project name"
          },
          "path": {
            "type": "string",
            "description": "Path to project relative to workspace root (use ../ for sibling directories)",
            "examples": ["../lucid-knowledge", "./packages/core"]
          },
          "absolutePath": {
            "type": "string",
            "description": "Absolute path to project directory"
          },
          "type": {
            "type": "string",
            "enum": ["library", "service", "application", "tool", "docs", "config", "planning"],
            "description": "Project type classification"
          },
          "role": {
            "type": "string",
            "enum": ["primary", "supporting", "shared"],
            "description": "Role within the workspace",
            "default": "primary"
          },
          "description": {
            "type": "string",
            "description": "Brief project description"
          },
          "language": {
            "type": "string",
            "description": "Primary programming language",
            "examples": ["Python", "TypeScript", "Dart"]
          },
          "framework": {
            "type": "string",
            "description": "Primary framework if applicable",
            "examples": ["Neo4j", "FastAPI", "Flutter"]
          },
          "gitRemote": {
            "type": "string",
            "format": "uri",
            "description": "Git remote URL"
          },
          "defaultBranch": {
            "type": "string",
            "description": "Default git branch name",
            "default": "main"
          },
          "status": {
            "type": "string",
            "enum": ["active", "archived", "deprecated"],
            "description": "Project status",
            "default": "active"
          }
        }
      },
      "minItems": 0
    },

    "projectMap": {
      "type": "string",
      "description": "Path to project-map.json file containing detailed source maps for all projects",
      "default": "project-map.json"
    },

    "settings": {
      "type": "object",
      "description": "Workspace-level settings",
      "properties": {
        "defaultShell": {
          "type": "string",
          "description": "Default shell for workspace commands",
          "default": "/bin/zsh"
        },
        "sharedConfigs": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Shared configuration files applied across projects",
          "default": []
        },
        "syncOnChange": {
          "type": "boolean",
          "description": "Automatically sync indexes to projects when summaries change",
          "default": true
        }
      }
    },

    "metadata": {
      "type": "object",
      "description": "Workspace metadata",
      "properties": {
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "When workspace was created"
        },
        "updated": {
          "type": "string",
          "format": "date-time",
          "description": "When workspace was last updated"
        },
        "createdBy": {
          "type": "string",
          "description": "User who created workspace"
        },
        "version": {
          "type": "string",
          "description": "Workspace configuration version",
          "default": "2.0.0"
        }
      }
    }
  },

  "examples": [
    {
      "id": "lucid-workspace",
      "name": "Lucid Workspace",
      "description": "Capability-driven development workspace for Lucid Commons strata management platform",
      "type": "hybrid",
      "rootPath": "/Users/rayk/Projects/lucid-workspace",
      "primaryStack": "Python",
      "directories": {
        "capabilities": "capabilities/",
        "outcomes": "outcomes/",
        "plans": "plans/",
        "research": "research/",
        "status": "status/",
        "schemas": "schemas/"
      },
      "intellij": {
        "ideaDirectory": ".idea/",
        "workspaceFile": ".idea/jb-workspace.xml",
        "modulesFile": ".idea/modules.xml"
      },
      "projects": [
        {
          "id": "lucid-knowledge",
          "name": "Lucid Knowledge",
          "path": "../lucid-knowledge",
          "absolutePath": "/Users/rayk/Projects/lucid-knowledge",
          "type": "library",
          "role": "primary",
          "description": "Knowledge graph evolution and query system built on Neo4j",
          "language": "Python",
          "framework": "Neo4j",
          "gitRemote": "git@github.com:rayk/lucid-knowledge.git",
          "defaultBranch": "main",
          "status": "active"
        },
        {
          "id": "lucid-toolkit",
          "name": "Lucid Toolkit",
          "path": "../lucid-toolkit",
          "absolutePath": "/Users/rayk/Projects/lucid-toolkit",
          "type": "tool",
          "role": "supporting",
          "description": "Claude Code plugin marketplace with capability-driven development workflows",
          "language": "Markdown",
          "gitRemote": "git@github.com:rayk/lucid-toolkit.git",
          "defaultBranch": "main",
          "status": "active"
        }
      ],
      "projectMap": "project-map.json",
      "settings": {
        "defaultShell": "/bin/zsh",
        "sharedConfigs": [".editorconfig"],
        "syncOnChange": true
      },
      "metadata": {
        "created": "2025-11-29T17:30:00Z",
        "updated": "2025-11-29T21:45:00Z",
        "createdBy": "rayk",
        "version": "2.0.0"
      }
    }
  ]
}
